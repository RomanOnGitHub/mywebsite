---
interface Props {
  title?: string;
}

const { title } = Astro.props;
const segments = Astro.url.pathname.split('/').filter(Boolean);

// Создаём хлебные крошки из сегментов URL
const crumbs = segments.map((segment, i) => {
  const path = '/' + segments.slice(0, i + 1).join('/');
  // Улучшаем читаемость: заменяем дефисы на пробелы и делаем первую букву заглавной
  const label = segment
    .replace(/-/g, ' ')
    .split(' ')
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
  
  return {
    label,
    href: path + (path !== '/' ? '/' : ''),
    isLast: i === segments.length - 1,
  };
});
---

<nav aria-label="Breadcrumb" class="text-sm mb-6">
  <ol 
    class="flex flex-wrap items-center gap-2 text-gray-600 dark:text-gray-400"
    itemscope 
    itemtype="https://schema.org/BreadcrumbList"
  >
    <!-- Главная -->
    <li 
      itemprop="itemListElement" 
      itemscope 
      itemtype="https://schema.org/ListItem"
      class="flex items-center"
    >
      <a 
        href="/" 
        itemprop="item"
        class="hover:text-gray-900 dark:hover:text-gray-100 transition-colors"
      >
        <span itemprop="name">Главная</span>
      </a>
      <meta itemprop="position" content="1" />
    </li>
    
    {crumbs.map((crumb, i) => (
      <>
        <li class="text-gray-400" aria-hidden="true">/</li>
        <li 
          itemprop="itemListElement" 
          itemscope 
          itemtype="https://schema.org/ListItem"
          class="flex items-center"
        >
          {crumb.isLast ? (
            <span 
              class="text-gray-900 dark:text-gray-100 font-medium"
              itemprop="name"
              aria-current="page"
            >
              {title || crumb.label}
            </span>
          ) : (
            <a 
              href={crumb.href}
              itemprop="item"
              class="hover:text-gray-900 dark:hover:text-gray-100 transition-colors"
            >
              <span itemprop="name">{crumb.label}</span>
            </a>
          )}
          <meta itemprop="position" content={String(i + 2)} />
        </li>
      </>
    ))}
  </ol>
</nav>
